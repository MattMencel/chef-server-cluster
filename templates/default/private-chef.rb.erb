# private-chef.rb

# This is an example for the new Hosted Enterprise Chef cookbook.
# The configuration below is an example of a postgresql server, note
# that all services are disabled and only postgresql is `true` also
# it's still required to set backend/frontend as approriate

topology "<%= node['ec']['topology'] %>"

<% @ec_vars[:disabled_svcs].each do |svc| %>
    <%= svc %>['enable'] = false
<% end %>
<% @ec_vars[:enabled_svcs].each do |svc| %>
    <%= svc %>['enable'] = true
<% end %>

<% @ec_vars[:vips].each do |vip_svc| %>
    <%= vip_svc %>['vip'] = "<%= node['fqdn'] %>"
<% end %>

server "<%= node['fqdn'] %>",
    <% if @ec_vars[:bootstrap] %>
    :bootstrap => true,
    <% end %>
    :role => "<%= @ec_vars[:role] %>",
    :ipaddress => "<%= node['ipaddress'] %>"
